@model DentalClinicSystem.Models.Treatment
@{
    ViewData["Title"] = "Treatment Details";
    Layout = "_DashboardLayout";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-procedures me-2 text-primary"></i>Treatment Details</h2>
    <div class="btn-group">
        <a asp-action="Index" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Back to List
        </a>
        <a asp-action="Edit" asp-route-id="@Model.TreatmentId" class="btn btn-warning">
            <i class="fas fa-edit me-2"></i>Edit
        </a>
        <a asp-action="Delete" asp-route-id="@Model.TreatmentId" class="btn btn-danger">
            <i class="fas fa-trash me-2"></i>Delete
        </a>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Treatment Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Treatment ID:</label>
                        <p class="form-control-plaintext">@Model.TreatmentId</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Treatment Type:</label>
                        <p class="form-control-plaintext">@Model.TreatmentType</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Treatment Date:</label>
                        <p class="form-control-plaintext">@Model.TreatmentDate.ToString("MMM dd, yyyy")</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Cost:</label>
                        <p class="form-control-plaintext">@Model.Cost.ToString("C")</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Status:</label>
                        <p class="form-control-plaintext">
                            @if (Model.Status == "Completed" || Model.Status == "مكتمل")
                            {
                                <span class="badge bg-success">@Model.Status</span>
                            }
                            else if (Model.Status == "In Progress" || Model.Status == "قيد التنفيذ")
                            {
                                <span class="badge bg-warning">@Model.Status</span>
                            }
                            else if (Model.Status == "Scheduled" || Model.Status == "مجدول")
                            {
                                <span class="badge bg-info">@Model.Status</span>
                            }
                            else
                            {
                                <span class="badge bg-secondary">@Model.Status</span>
                            }
                        </p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Duration (Minutes):</label>
                        <p class="form-control-plaintext">@(Model.DurationMinutes?.ToString() ?? "Not specified")</p>
                    </div>
                </div>

                @if (!string.IsNullOrEmpty(Model.Description))
                {
                    <div class="mb-3">
                        <label class="form-label fw-bold">Description:</label>
                        <p class="form-control-plaintext">@Model.Description</p>
                    </div>
                }

                @if (!string.IsNullOrEmpty(Model.Notes))
                {
                    <div class="mb-3">
                        <label class="form-label fw-bold">Notes:</label>
                        <p class="form-control-plaintext">@Model.Notes</p>
                    </div>
                }

                @if (!string.IsNullOrEmpty(Model.ClinicalNotes))
                {
                    <div class="mb-3">
                        <label class="form-label fw-bold">Clinical Notes:</label>
                        <p class="form-control-plaintext">@Model.ClinicalNotes</p>
                    </div>
                }

                @if (!string.IsNullOrEmpty(Model.TeethTreated))
                {
                    <div class="mb-3">
                        <label class="form-label fw-bold">Teeth Treated:</label>
                        <p class="form-control-plaintext">@Model.TeethTreated</p>
                    </div>
                }

                @if (!string.IsNullOrEmpty(Model.PostTreatmentInstructions))
                {
                    <div class="mb-3">
                        <label class="form-label fw-bold">Post-Treatment Instructions:</label>
                        <p class="form-control-plaintext">@Model.PostTreatmentInstructions</p>
                    </div>
                }

                @if (Model.NextAppointmentSuggested.HasValue)
                {
                    <div class="mb-3">
                        <label class="form-label fw-bold">Next Appointment Suggested:</label>
                        <p class="form-control-plaintext">@Model.NextAppointmentSuggested.Value.ToString("MMM dd, yyyy")</p>
                    </div>
                }
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <!-- Patient Information -->
        <div class="card mb-3">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-user me-2"></i>Patient Information</h6>
            </div>
            <div class="card-body">
                @if (Model.Patient != null)
                {
                    <p class="mb-1"><strong>Name:</strong> @Model.Patient.FullName</p>
                    <p class="mb-1"><strong>Phone:</strong> @Model.Patient.Phone</p>
                    <p class="mb-0"><strong>Age:</strong> @(Model.Patient.DateOfBirth.HasValue ? (DateTime.Now.Year - Model.Patient.DateOfBirth.Value.Year) : 0) years</p>
                    <a asp-controller="Patients" asp-action="Details" asp-route-id="@Model.PatientId" class="btn btn-sm btn-outline-primary mt-2">
                        <i class="fas fa-eye me-1"></i>View Patient Profile
                    </a>
                }
                else
                {
                    <p class="text-muted">Patient information not available</p>
                }
            </div>
        </div>

        <!-- Dentist Information -->
        <div class="card mb-3">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-user-md me-2"></i>Dentist Information</h6>
            </div>
            <div class="card-body">
                @if (Model.Dentist != null)
                {
                    <p class="mb-1"><strong>Name:</strong> @Model.Dentist.FullName</p>
                    <p class="mb-1"><strong>Specialization:</strong> @Model.Dentist.Specialization</p>
                    <p class="mb-0"><strong>Phone:</strong> @Model.Dentist.Phone</p>
                    <a asp-controller="Dentists" asp-action="Details" asp-route-id="@Model.DentistId" class="btn btn-sm btn-outline-primary mt-2">
                        <i class="fas fa-eye me-1"></i>View Dentist Profile
                    </a>
                }
                else
                {
                    <p class="text-muted">Dentist information not available</p>
                }
            </div>
        </div>

        <!-- Service Information -->
        @if (Model.Service != null)
        {
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0"><i class="fas fa-cog me-2"></i>Service Information</h6>
                </div>
                <div class="card-body">
                    <p class="mb-1"><strong>Service Name:</strong> @Model.Service.ServiceName</p>
                    <p class="mb-1"><strong>Price:</strong> @Model.Service.Price.ToString("C")</p>
                    <p class="mb-0"><strong>Duration:</strong> @Model.Service.Duration minutes</p>
                </div>
            </div>
        }

        <!-- Appointment Information -->
        @if (Model.Appointment != null)
        {
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0"><i class="fas fa-calendar me-2"></i>Appointment Information</h6>
                </div>
                <div class="card-body">
                    <p class="mb-1"><strong>Appointment Date:</strong> @Model.Appointment.AppointmentDate.ToString("MMM dd, yyyy")</p>
                    <p class="mb-1"><strong>Time:</strong> @Model.Appointment.StartTime.ToString(@"hh\:mm")</p>
                    <p class="mb-0"><strong>Appointment Status:</strong> @Model.Appointment.Status</p>
                    <a asp-controller="Appointments" asp-action="Details" asp-route-id="@Model.AppointmentId" class="btn btn-sm btn-outline-primary mt-2">
                        <i class="fas fa-eye me-1"></i>View Appointment Details
                    </a>
                </div>
            </div>
        }

        <!-- Timestamps -->
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-clock me-2"></i>System Information</h6>
            </div>
            <div class="card-body">
                <p class="small mb-1"><strong>Created At:</strong> @Model.CreatedAt.ToString("MMM dd, yyyy hh:mm tt")</p>
                @if (Model.UpdatedAt.HasValue)
                {
                    <p class="small mb-0"><strong>Last Updated:</strong> @Model.UpdatedAt.Value.ToString("MMM dd, yyyy hh:mm tt")</p>
                }
            </div>
        </div>
    </div>
</div>
